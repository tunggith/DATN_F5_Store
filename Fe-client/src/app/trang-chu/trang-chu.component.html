<div class="pos_page">
  <div class="container">
    <div class="pos_page_inner">
      <div class="pos_home_section">
        <div class="row pos_home">
          <!-- Main Content Start -->
          <div class="col-lg-12 col-md-12">
            <!-- Custom Image Slider Start -->
            <div class="blockSlider mb-4">
              <div class="slider">
                <div class="slider-image">
                  <img [src]="sliderImages[currentIndex]" alt="Slider Image" />
                </div>
              </div>
            </div>
            <!-- Custom Image Slider End -->
            <hr>
            <div class="featured_product mb-4">
              <div class="icon-section">
                <div class="icon-item">
                  <div class="icon">
                    <img src="https://baobihuuco.com/wp-content/uploads/2019/04/icon-giao-hang-toan-quoc.jpg" alt="Icon 1">
                  </div>
                  <div class="description">
                    <h3>Giao Hàng Nhanh</h3>
                    <p>Nhận hàng chỉ sau 3-4 ngày</p>
                  </div>
                </div>
                <div class="icon-item">
                  <div class="icon">
                    <img src="https://media.istockphoto.com/id/1445748121/vi/vec-to/gi%E1%BA%A3i-%C4%91%E1%BA%B7c-bi%E1%BB%87t-qu%C3%A0-th%C6%B0%E1%BB%9Fng-h%E1%BB%99p-qu%C3%A0-b%E1%BA%A5t-ng%E1%BB%9D-qu%C3%A0-m%C3%A0u-v%C3%A0ng-v%E1%BB%9Bi-ruy-b%C4%83ng-%C4%91%E1%BB%8F-kh%C3%A1i-ni%E1%BB%87m-ti%E1%BB%81n-th%C6%B0%E1%BB%9Fng.jpg?s=612x612&w=0&k=20&c=6ujfNRcWNtOvFn3kP_J3on6BT4kdIw1LApVltxfX_10=" alt="Icon 2">
                  </div>
                  <div class="description">
                    <h3>Quà tặng hấp dẫn</h3>
                    <p>Nhiều ưu đãi khuyến mãi hot</p>
                  </div>
                </div>
                <div class="icon-item">
                  <div class="icon">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR3dh_MSDWMcxaEmPdJp4UJwGV3IPUj7QDXFb9_ii2UtdmER-XSz4LVjis882Ck450n7eY&usqp=CAU" alt="Icon 3">
                  </div>
                  <div class="description">
                    <h3>Chất liệu chất lượng </h3>
                    <p>Yên tâm mua sắm</p>
                  </div>
                </div>
                <div class="icon-item">
                  <div class="icon">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQnE2ngy3rewx3qM_zt_hlQ-QAyzC0dBi_7IA&s" alt="Icon 3">
                  </div>
                  <div class="description">
                    <h3>Hotline: 0345.97.97.97</h3>
                    <p>Hỗ trợ bạn từ 9h00-22h00</p>
                  </div>
                </div>
              </div>
              <!--  rải voucher  -->
              <div class="featured_product mb-4">
                <div class="block_title text-center">
                  <h3 class="blinking-text"> voucher </h3>
                </div>
                <div class="voucher-container">
                  <div *ngFor="let voucherItem of voucher" class="voucher-card">
                    <h3>{{ voucherItem.ten }}</h3>
                    <p>
                      Nhập mã <strong>{{ voucherItem.ma }}</strong><br>
                      {{ voucherItem.moTa }}
                    </p>
                    <button class="copy-button" (click)="copyCode(voucherItem)">
                      {{ voucherItem.isCopied ? 'Đã Copy' : 'Copy' }}
                    </button>
                  </div>
                </div>
              </div>


              <!-- rải voucher end  -->
              <hr>
            </div>
            <!-- New Products Start -->
            <div class="featured_product mb-4">
              <div class="block_title text-center">
                <h3 class="blinking-text">Sản phẩm mới</h3>
              </div>
              <div *ngIf="newSanPham && newSanPham.length > 0; else noData"
                class="product_list d-flex flex-wrap justify-content-between">
                <div *ngFor="let product of newSanPham" class="single_product">
                  <div class="product_thumb">
                    <div class="img_label">New</div>
                    <a (click)="openPopup(product.chiTietSanPham.sanPham.id)">
                      <img [src]="product.urlAnh || 'assets/img/product/default.jpg'"
                        alt="{{ product.chiTietSanPham.ten || 'Product' }}">
                    </a>
                    <!-- Nút mở popup -->
                    <div class="product_action">
                      <button class="add_to_cart" (click)="openPopup(product.chiTietSanPham.sanPham.id)">
                        <i class="fa fa-shopping-cart"></i> Chi tiết
                      </button>
                    </div>
                  </div>
                  <div class="product_content">
                    <span class="product_price_sales" *ngIf="product.chiTietSanPham.checkKm===true">{{
                      product.chiTietSanPham.donGiaBanDau | number }} VND</span>
                    <span class="product_price">{{ product.chiTietSanPham.donGia | number }} VND</span>
                    <!-- <span class="mota">{{product.chiTietSanPham.moTa}}</span> -->
                    <h3 class="product_title">
                      <a (click)="openPopup(product.chiTietSanPham.sanPham.id)">{{ product.chiTietSanPham.sanPham.ten ||
                        'Unnamed Product' }} - {{ product.chiTietSanPham.sanPham.gioiTinh.ten || 'Unnamed Product'
                        }}</a>
                    </h3>
                  </div>
                  <!-- <div class="product_info">
                      <ul>
                        <li><a href="#" title="Add to Wishlist">Add to Wishlist</a></li>
                        <li><a href="#" data-toggle="modal" data-target="#modal_box" title="Quick view">View Detail</a></li>
                      </ul>
                    </div> -->
                </div>
              </div>
              <ng-template #noData>
                <p>Dữ liệu sản phẩm trống hoặc chưa tải.</p>
              </ng-template>
            </div>
            <!-- New Products End -->

            <!-- Hot Products Start -->
            <div class="featured_product mb-4">
              <div class="block_title text-center">
                <h3 class="blinking-text">Sản Phẩm Hot</h3>
              </div>
              <div *ngIf="HotSanPham && HotSanPham.length > 0; else noData"
                class="product_list d-flex flex-wrap justify-content-between">
                <div *ngFor="let product of HotSanPham" class="single_product">
                  <div class="product_thumb">
                    <div class="img_label">Hot</div>
                    <a (click)="openPopup(product.chiTietSanPham.sanPham.id)">
                      <img [src]="product.urlAnh || 'assets/img/product/default.jpg'"
                        alt="{{ product.chiTietSanPham.ten || 'Product' }}">
                    </a>
                    <div class="product_action">
                      <button class="add_to_cart" (click)="openPopup(product.chiTietSanPham.sanPham.id)">
                        <i class="fa fa-shopping-cart"></i> Chi Tiết
                      </button>
                    </div>
                  </div>
                  <div class="product_content">
                    <span class="product_price_sales" *ngIf="product.chiTietSanPham.checkKm===true">{{
                      product.chiTietSanPham.donGiaBanDau | number }} VND</span>
                    <span class="product_price">{{ product.chiTietSanPham.donGia | number }} VND</span>
                    <!-- <span class="mota">{{product.chiTietSanPham.moTa}}</span> -->
                    <h3 class="product_title">
                      <a (click)="openPopup(product.chiTietSanPham.sanPham.id)">{{ product.chiTietSanPham.sanPham.ten ||
                        'Unnamed Product' }} - {{ product.chiTietSanPham.sanPham.gioiTinh.ten || 'Unnamed Product'
                        }}</a>
                    </h3>
                  </div>
                  <!-- <div class="product_info">
                      <ul>
                        <li><a href="#" title="Add to Wishlist">Add to Wishlist</a></li>
                        <li><a href="#" data-toggle="modal" data-target="#modal_box" title="Quick view">View Detail</a></li>
                      </ul>
                    </div> -->
                </div>
              </div>
              <ng-template #noData>
                <p>Dữ liệu sản phẩm trống hoặc chưa tải.</p>
              </ng-template>
            </div>
            <!-- Hot Products End -->

            <!-- Banner Area Start -->
            <!-- <div class="banner_area mb-4">
                <div class="row">
                    <div class="col-lg-6 col-md-6">
                        <div class="single_banner">
                            <a href="#"><img src="assets/img/banner/banner7.jpg" alt="Banner Image"></a>
                            <div class="banner_title">
                                <p>Up to <span>40%</span> off</p>
                                <a href="#" class="shop_now_btn">Shop Now</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <div class="single_banner">
                            <a href="#"><img src="assets/img/banner/banner8.jpg" alt="Banner Image"></a>
                            <div class="banner_title title_2">
                                <p>Sale off <span>30%</span></p>
                                <a href="#" class="shop_now_btn">Shop Now</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->

            <!-- Banner Area End -->

          </div>
          <!-- Main Content End -->
        </div>
      </div>
    </div>
  </div>
</div>

<!--  modal -->


<!-- Popup -->
<div class="popup" *ngIf="isPopupVisible">
  <div class="popup-content">
    <!-- Nút đóng -->
    <span class="close" (click)="closePopup()">&times;</span>

    <div class="popup-body">
      <!-- Phần bên trái: Hình ảnh -->
      <div class="popup-left">
        <!-- Ảnh chính -->
        <img [src]="currentImage" alt="Product Image" class="popup-image" />

        <!-- Danh sách ảnh thu nhỏ -->
        <div class="image-list">
          <img *ngFor="let anh of anhChiTietSanPham" [src]="anh.urlAnh" class="thumbnail"
            [class.selected]="currentImage === anh.urlAnh" (click)="changeImage(anh.urlAnh)" />
        </div>
      </div>

      <!-- Phần bên phải: Nội dung sản phẩm -->
      <div class="popup-right">
        <p>Mã sản phẩm: <strong>{{ maSanPham }}</strong></p>
        <h2>Sản Phẩm: <strong>{{ tenSanPham }}</strong></h2>

        <p><strong>Thương hiệu:</strong> {{ ThuongHieu }}</p>
        <p><strong>Xuất xứ:</strong> {{ XuatXu }}</p>
        <p><strong>Giới tính:</strong> {{ gioiTinh }}</p>

        <p>
          <strong>Giá:</strong>
          <span class="price">{{ formatTien(donGia) }} VND</span>
          <span class="price-sale" *ngIf="checkKm===true">{{ formatTien(donGiaDau) }} VND</span>
        </p>

        <div class="options">
          <div class="colors">
            <strong>Màu sắc:</strong>
            <div class="option-buttons">
              <ng-container *ngFor="let color of mauSacList">
                <button [class.selected]="color === selectedColor" (click)="selectColor(color)">
                  {{ color.ten }}
                </button>
              </ng-container>
            </div>
          </div>

          <div class="sizes">
            <strong>Kích thước:</strong>
            <div class="option-buttons">
              <ng-container *ngFor="let kichthuoc of sizeList">
                <button [class.selected]="kichthuoc === selectedSize" (click)="selectSize(kichthuoc)">
                  {{ kichthuoc.ten }}
                </button>
              </ng-container>
            </div>
          </div>
        </div>

        <div class="stock-status">
          <strong>Trạng thái hàng:</strong>
          <span *ngIf="soLuongCTSP === 0" style="color: red;">Hết hàng</span>
          <span *ngIf="soLuongCTSP > 0" style="color: brown;">
            Còn {{ soLuongCTSP }}
          </span>
        </div>

        <div class="quantity-container">
          <strong>Số lượng:</strong>
          <div class="quantity">
            <button (click)="decreaseQuantity()">-</button>
            <input type="text" [(ngModel)]="quantity" min="1" [max]="soLuongCTSP" (input)="onQuantityChange($event)" />
            <button (click)="increaseQuantity()">+</button>
          </div>
          <p class="error-message" *ngIf="err2">{{ err2 }}</p>
        </div>

        <button class="add-to-cart" (click)="themSanPham()" [disabled]="quantity == 0">Thêm vào giỏ</button>
      </div>
    </div>
  </div>
</div>